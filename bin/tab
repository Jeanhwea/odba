#!/bin/bash
HERE=$(cd $(dirname $0); pwd)
ROOT=$(git -C ${HERE} rev-parse --show-toplevel)

source "${ROOT}/bin/setup"

cd ${ROOT} && echo "Connect to ${conn} in $(pwd)"
tabs=($(sqlplus -SL ${conn} < dt.sql | sed '1,/---/d' | awk '{print $1}'))

select tab in ${tabs[@]}; do
  if [ "${tab}" != '' ]; then
    echo 'exit' | sqlplus -SL ${conn} @t ${tab} \
      && break
  else
    read -p 'filter with: ' ans
    tabs=($(echo ${aa[@]} | tr ' ' '\n' | grep -i "${ans}"))
    [ ${#tabs[@]} -eq 1 ] && \
      echo 'exit' | sqlplus -SL ${conn} @t ${tab[0]} \
      && break
  fi
done
